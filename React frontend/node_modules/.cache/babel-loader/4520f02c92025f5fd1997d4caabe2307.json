{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nconst ALLOWED_TOKENS = new Set([\"no-referrer\", \"no-referrer-when-downgrade\", \"same-origin\", \"origin\", \"strict-origin\", \"origin-when-cross-origin\", \"strict-origin-when-cross-origin\", \"unsafe-url\", \"\"]);\n\nfunction getHeaderValueFromOptions({\n  policy = [\"no-referrer\"]\n}) {\n  const tokens = typeof policy === \"string\" ? [policy] : policy;\n\n  if (tokens.length === 0) {\n    throw new Error(\"Referrer-Policy received no policy tokens\");\n  }\n\n  const tokensSeen = new Set();\n  tokens.forEach(token => {\n    if (!ALLOWED_TOKENS.has(token)) {\n      throw new Error(`Referrer-Policy received an unexpected policy token ${JSON.stringify(token)}`);\n    } else if (tokensSeen.has(token)) {\n      throw new Error(`Referrer-Policy received a duplicate policy token ${JSON.stringify(token)}`);\n    }\n\n    tokensSeen.add(token);\n  });\n  return tokens.join(\",\");\n}\n\nfunction referrerPolicy(options = {}) {\n  const headerValue = getHeaderValueFromOptions(options);\n  return function referrerPolicyMiddleware(_req, res, next) {\n    res.setHeader(\"Referrer-Policy\", headerValue);\n    next();\n  };\n}\n\nmodule.exports = referrerPolicy;\nexports.default = referrerPolicy;","map":{"version":3,"sources":["C:/Users/Yoni/Desktop/maruf/movie/node_modules/helmet/dist/middlewares/referrer-policy/index.js"],"names":["Object","defineProperty","exports","value","ALLOWED_TOKENS","Set","getHeaderValueFromOptions","policy","tokens","length","Error","tokensSeen","forEach","token","has","JSON","stringify","add","join","referrerPolicy","options","headerValue","referrerPolicyMiddleware","_req","res","next","setHeader","module","default"],"mappings":"AAAA;;AACAA,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AAAEC,EAAAA,KAAK,EAAE;AAAT,CAA7C;AACA,MAAMC,cAAc,GAAG,IAAIC,GAAJ,CAAQ,CAAC,aAAD,EAAgB,4BAAhB,EAA8C,aAA9C,EAA6D,QAA7D,EAAuE,eAAvE,EAAwF,0BAAxF,EAAoH,iCAApH,EAAuJ,YAAvJ,EAAqK,EAArK,CAAR,CAAvB;;AACA,SAASC,yBAAT,CAAmC;AAAEC,EAAAA,MAAM,GAAG,CAAC,aAAD;AAAX,CAAnC,EAAiE;AAChE,QAAMC,MAAM,GAAG,OAAOD,MAAP,KAAkB,QAAlB,GAA6B,CAACA,MAAD,CAA7B,GAAwCA,MAAvD;;AACA,MAAIC,MAAM,CAACC,MAAP,KAAkB,CAAtB,EAAyB;AACxB,UAAM,IAAIC,KAAJ,CAAU,2CAAV,CAAN;AACA;;AACD,QAAMC,UAAU,GAAG,IAAIN,GAAJ,EAAnB;AACAG,EAAAA,MAAM,CAACI,OAAP,CAAeC,KAAK,IAAI;AACvB,QAAI,CAACT,cAAc,CAACU,GAAf,CAAmBD,KAAnB,CAAL,EAAgC;AAC/B,YAAM,IAAIH,KAAJ,CAAW,uDAAsDK,IAAI,CAACC,SAAL,CAAeH,KAAf,CAAsB,EAAvF,CAAN;AACA,KAFD,MAEO,IAAIF,UAAU,CAACG,GAAX,CAAeD,KAAf,CAAJ,EAA2B;AACjC,YAAM,IAAIH,KAAJ,CAAW,qDAAoDK,IAAI,CAACC,SAAL,CAAeH,KAAf,CAAsB,EAArF,CAAN;AACA;;AACDF,IAAAA,UAAU,CAACM,GAAX,CAAeJ,KAAf;AACA,GAPD;AAQA,SAAOL,MAAM,CAACU,IAAP,CAAY,GAAZ,CAAP;AACA;;AACD,SAASC,cAAT,CAAwBC,OAAO,GAAG,EAAlC,EAAsC;AACrC,QAAMC,WAAW,GAAGf,yBAAyB,CAACc,OAAD,CAA7C;AACA,SAAO,SAASE,wBAAT,CAAkCC,IAAlC,EAAwCC,GAAxC,EAA6CC,IAA7C,EAAmD;AACzDD,IAAAA,GAAG,CAACE,SAAJ,CAAc,iBAAd,EAAiCL,WAAjC;AACAI,IAAAA,IAAI;AACJ,GAHD;AAIA;;AACDE,MAAM,CAACzB,OAAP,GAAiBiB,cAAjB;AACAjB,OAAO,CAAC0B,OAAR,GAAkBT,cAAlB","sourcesContent":["\"use strict\"\nObject.defineProperty(exports, \"__esModule\", { value: true })\nconst ALLOWED_TOKENS = new Set([\"no-referrer\", \"no-referrer-when-downgrade\", \"same-origin\", \"origin\", \"strict-origin\", \"origin-when-cross-origin\", \"strict-origin-when-cross-origin\", \"unsafe-url\", \"\"])\nfunction getHeaderValueFromOptions({ policy = [\"no-referrer\"] }) {\n\tconst tokens = typeof policy === \"string\" ? [policy] : policy\n\tif (tokens.length === 0) {\n\t\tthrow new Error(\"Referrer-Policy received no policy tokens\")\n\t}\n\tconst tokensSeen = new Set()\n\ttokens.forEach(token => {\n\t\tif (!ALLOWED_TOKENS.has(token)) {\n\t\t\tthrow new Error(`Referrer-Policy received an unexpected policy token ${JSON.stringify(token)}`)\n\t\t} else if (tokensSeen.has(token)) {\n\t\t\tthrow new Error(`Referrer-Policy received a duplicate policy token ${JSON.stringify(token)}`)\n\t\t}\n\t\ttokensSeen.add(token)\n\t})\n\treturn tokens.join(\",\")\n}\nfunction referrerPolicy(options = {}) {\n\tconst headerValue = getHeaderValueFromOptions(options)\n\treturn function referrerPolicyMiddleware(_req, res, next) {\n\t\tres.setHeader(\"Referrer-Policy\", headerValue)\n\t\tnext()\n\t}\n}\nmodule.exports = referrerPolicy\nexports.default = referrerPolicy\n"]},"metadata":{},"sourceType":"script"}